<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melffy Archetype Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* Light sky blue */
            color: #374151; /* Cool Gray */
            overflow-x: hidden;
        }

        .container {
            max-width: 1024px;
        }

        .card {
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 1px solid #e0f2fe; /* Lighter sky blue border */
        }
        
        .combo-step-card, .pro-con-card {
            background-color: #f0f9ff; /* Light sky blue */
            border: 1px solid #dbeafe; /* Light blue border */
        }

        .card-placeholder {
            background-color: #e0f2fe;
            color: #3b82f6; /* Blue */
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 0.875rem;
            font-weight: bold;
            height: 100%;
            border-radius: 1rem;
            padding: 0.5rem;
            cursor: pointer;
        }

        .card-image-container {
            width: 100%;
            max-width: 180px; /* Control the size of the image */
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 1rem;
        }
        
        .text-accent {
            color: #ec4899; /* Pink */
        }

        .heading-underline {
            border-bottom: 3px solid #fbbf24; /* Amber */
            display: inline-block;
            padding-bottom: 0.25rem;
        }

        .lore-link {
            color: #8b5cf6; /* Violet */
            font-weight: bold;
            text-decoration: none;
            border-bottom: 2px dotted #a78bfa;
            transition: color 0.3s;
        }

        .lore-link:hover {
            color: #ec4899; /* Pink on hover */
        }
        
        .ygo-home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #a78bfa 0%, #c4b5fd 100%);
            color: white;
            border: 2px solid #ddd6fe;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(167, 139, 250, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .ygo-home-button:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 8px 25px rgba(167, 139, 250, 0.6);
        }

        .ygo-home-button i {
            font-size: 24px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        /* Whimsical Banner */
        .banner {
            position: relative;
            height: 150px;
            background: linear-gradient(45deg, #fbcfe8, #dbeafe); /* Pink to light blue */
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 1.5rem;
            border: 2px solid #fff;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .banner-title {
            font-family: 'Comic Neue', cursive;
            font-size: 3rem;
            color: #8b5cf6;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .banner-subtitle {
            font-size: 1.1rem;
            color: #6366f1;
        }

        /* Floating Bubbles Animation */
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            opacity: 0;
            animation: float 10s infinite linear;
        }
        .bubble.b1 { width: 20px; height: 20px; left: 10%; animation-duration: 12s; animation-delay: 0s; }
        .bubble.b2 { width: 15px; height: 15px; left: 25%; animation-duration: 8s; animation-delay: 2s; }
        .bubble.b3 { width: 25px; height: 25px; left: 40%; animation-duration: 15s; animation-delay: 1s; }
        .bubble.b4 { width: 18px; height: 18px; left: 60%; animation-duration: 10s; animation-delay: 4s; }
        .bubble.b5 { width: 22px; height: 22px; left: 80%; animation-duration: 13s; animation-delay: 3s; }

        @keyframes float {
            0% { bottom: -50px; opacity: 0; }
            10% { opacity: 0.9; }
            90% { opacity: 0.9; }
            100% { bottom: 150px; opacity: 0; }
        }

        /* Popup styles */
        .popup {
            position: fixed;
            background: white;
            border: 3px solid #3b82f6;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            max-width: 400px;
            max-height: 600px;
            overflow-y: auto;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            font-family: 'Inter', sans-serif;
        }

        .popup.show {
            opacity: 1;
            pointer-events: auto;
        }

        .popup img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .popup h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
            font-weight: bold;
            color: #1f2937;
        }

        .popup p {
            margin: 5px 0;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .popup .type {
            font-weight: bold;
            color: #3b82f6;
        }

        .popup .stats {
            font-size: 0.9em;
            color: #6b7280;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <a href="index-refactored.html" class="ygo-home-button" title="Return to Archetype Nexus">
        <i class="fas fa-home"></i>
    </a>

    <div class="container mx-auto">
        <header class="mb-10 md:mb-16">
            <div class="banner">
                <div class="bubble b1"></div>
                <div class="bubble b2"></div>
                <div class="bubble b3"></div>
                <div class="bubble b4"></div>
                <div class="bubble b5"></div>
                <div class="banner-content">
                    <h1 class="banner-title">Melffy</h1>
                    <p class="banner-subtitle">An Analysis of the Forest's Cutest Critters</p>
                </div>
            </div>
        </header>

        <section class="mb-10 md:mb-16">
            <div class="card p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Executive Summary</h2>
                <p class="text-gray-600">
                    The <strong class="text-accent font-bold">Melffy</strong> archetype is a reactive, control-based strategy that thrives on disrupting the opponent during their own turn. The deck's core mechanic revolves around its Level 2 Beast monsters returning to the hand to trigger powerful effects, such as searching, summoning, and resource recovery. This unique playstyle, best described as "your turn is my turn," subverts traditional gameplay by punishing an opponent's actions rather than preemptively negating them. While a "Pure Melffy" build is viable, the archetype's true strength is unlocked when integrated with other powerful engines like <strong class="text-accent font-bold">Spright</strong> and <strong class="text-accent font-bold">Tri-Brigade</strong>.
                </p>
            </div>
        </section>

        <section class="mb-10 md:mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center heading-underline">The Melffy Friends</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Melffy Catty -->
                <div class="relative bg-gradient-to-br from-pink-100 via-blue-100 to-yellow-100 rounded-2xl shadow-lg border-2 border-pink-200 p-6 flex flex-col items-center hover:scale-105 transition-transform duration-300">
                    <div class="absolute top-3 right-3 text-pink-400 text-2xl animate-bounce">&#128049;</div>
                    <h3 id="melffy-catty" class="text-xl font-bold text-accent mb-2 text-center">Melffy Catty</h3>
                    <div id="catty-img-container" class="card-image-container rounded-xl overflow-hidden shadow-md mb-4" style="min-height: 180px; background: #fbcfe8;"></div>
                    <p class="text-gray-700 text-center">The primary searcher. When it returns to the hand, it adds any Beast monster from the Deck to your hand, giving you access to key combo pieces and non-archetypal support.</p>
                </div>
                <!-- Melffy Puppy -->
                <div class="relative bg-gradient-to-br from-blue-100 via-pink-100 to-yellow-100 rounded-2xl shadow-lg border-2 border-blue-200 p-6 flex flex-col items-center hover:scale-105 transition-transform duration-300">
                    <div class="absolute top-3 right-3 text-blue-400 text-2xl animate-bounce">&#128054;</div>
                    <h3 id="melffy-puppy" class="text-xl font-bold text-accent mb-2 text-center">Melffy Puppy</h3>
                    <div id="puppy-img-container" class="card-image-container rounded-xl overflow-hidden shadow-md mb-4" style="min-height: 180px; background: #dbeafe;"></div>
                    <p class="text-gray-700 text-center">Summons a Level 2 or lower Beast from the Deck when it returns to the hand. This is often used to bring out <strong class="text-accent font-bold">Kalantosa, Mystical Beast of the Forest</strong> for a quick destruction effect.</p>
                </div>
                <!-- Melffy Wally -->
                <div class="relative bg-gradient-to-br from-yellow-100 via-pink-100 to-blue-100 rounded-2xl shadow-lg border-2 border-yellow-200 p-6 flex flex-col items-center hover:scale-105 transition-transform duration-300">
                    <div class="absolute top-3 right-3 text-yellow-400 text-2xl animate-bounce">&#11088;</div>
                    <h3 id="melffy-wally" class="text-xl font-bold text-accent mb-2 text-center">Melffy Wally</h3>
                    <div id="wally-img-container" class="card-image-container rounded-xl overflow-hidden shadow-md mb-4" style="min-height: 180px; background: #fef9c3;"></div>
                    <p class="text-gray-700 text-center">A powerful swarm tool that summons two different "Melffy" monsters from the Deck, quickly establishing your engine and generating significant card advantage.</p>
                </div>
            </div>
        </section>

        <section class="mb-10 md:mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center heading-underline">Typical End Board</h2>
            <div class="card p-6">
                <p class="text-gray-600 mb-4">
                    A typical Melffy end board is not about creating a wall of negates, but rather a field of interactive threats that punish your opponent's plays. The goal is to have multiple "Melffy" monsters on the field, ready to bounce back to the hand and trigger their effects. Come and play 
                    <a href="https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=15290" target="_blank" class="lore-link">hide-and-seek with our fluffy friends</a>!
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="combo-step-card p-4 rounded-lg">
                        <h4 class="font-bold text-lg text-gray-800">Core Interaction Engine</h4>
                        <p class="text-gray-600">A face-up <strong class="text-accent font-bold">Melffy Catty</strong> and <strong class="text-accent font-bold">Melffy Puppy</strong> on the field, ready to search and summon on your opponent's turn.</p>
                    </div>
                    <div class="combo-step-card p-4 rounded-lg">
                        <h4 class="font-bold text-lg text-gray-800">XYZ Presence</h4>
                        <p class="text-gray-600"><strong class="text-accent font-bold">Melffy of the Forest</strong> provides a lingering monster negate, while <strong class="text-accent font-bold">Joyous Melffys</strong> can recycle your resources.</p>
                    </div>
                    <div class="combo-step-card p-4 rounded-lg">
                        <h4 class="font-bold text-lg text-gray-800">Synchro Disruption</h4>
                        <p class="text-gray-600">Access to <strong class="text-accent font-bold">Herald of the Arc Light</strong> via <strong class="text-accent font-bold">Melffy Pinny</strong> or <strong class="text-accent font-bold">Hop Ear Squadron</strong> for an omni-negate.</p>
                    </div>
                    <div class="combo-step-card p-4 rounded-lg">
                        <h4 class="font-bold text-lg text-gray-800">Powerful Board Wipe</h4>
                         <p class="text-gray-600">The ability to go into <strong class="text-accent font-bold">Divine Arsenal AA-ZEUS - Sky Thunder</strong> after a battle phase, providing a powerful board-clearing option.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-10 md:mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center heading-underline">Competitive Analysis</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Strengths -->
                <div class="pro-con-card card p-6">
                    <h3 class="text-xl font-bold text-green-500 mb-4">Strengths</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                        <li><strong class="text-green-500">Resource Loop:</strong> The ability to constantly recycle resources makes the deck excel in longer, grind-based games.</li>
                        <li><strong class="text-green-500">High Ceiling with Hybrids:</strong> When combined with engines like Spright or Tri-Brigade, the deck can produce oppressive end boards.</li>
                        <li><strong class="text-green-500">Unexpected OTK Potential:</strong> Joyous Melffys allows for direct attacks, which can quickly end the game.</li>
                    </ul>
                </div>
                <!-- Weaknesses -->
                <div class="pro-con-card card p-6">
                    <h3 class="text-xl font-bold text-red-500 mb-4">Weaknesses</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                        <li><strong class="text-red-500">Reactive Nature:</strong> Relies on the opponent to make a move, making it vulnerable to floodgates.</li>
                        <li><strong class="text-red-500">Vulnerability to Backrow:</strong> Limited in-engine ways to deal with powerful Spell and Trap cards.</li>
                        <li><strong class="text-red-500">Identifiable Choke Points:</strong> Key starters like <strong class="text-accent font-bold">Rescue Cat</strong> and <strong class="text-accent font-bold">Obedience Schooled</strong> are vulnerable to hand traps.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="mb-10 md:mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center heading-underline">TCG Banlist Impact</h2>
            <div class="card p-6">
                <p class="text-gray-700 mb-4 text-center">
                    <strong class="text-pink-500 font-bold">CURRENT STATUS:</strong> The Melffy archetype is lightly touched by the current TCG banlist, with most core cards unrestricted:
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="combo-step-card p-4 rounded-lg bg-pink-100 border-l-4 border-pink-400">
                        <h4 class="text-lg font-bold text-pink-500 mb-2">Forbidden/Limited Cards</h4>
                        <ul id="melffy-banlist-forbidden" class="list-disc list-inside space-y-1 text-sm text-gray-700"></ul>
                    </div>
                    <div class="combo-step-card p-4 rounded-lg bg-blue-100 border-l-4 border-blue-400">
                        <h4 class="text-lg font-bold text-blue-500 mb-2">Unrestricted Cards</h4>
                        <ul id="melffy-banlist-unrestricted" class="list-disc list-inside space-y-1 text-sm text-gray-700"></ul>
                    </div>
                </div>
                <div id="melffy-banlist-meta" class="mt-4 p-3 bg-pink-200 bg-opacity-40 rounded border-l-4 border-pink-400">
                    <!-- Meta implications will be inserted here -->
                </div>
            </div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const popup = document.getElementById('card-popup');
            let activePopup = null;
            let cardDataCache = {};

            // Card image loader with caching
            async function fetchAndProcessCardData(cardName, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;

                if (cardDataCache[cardName]) {
                    displayCardImage(cardDataCache[cardName], container);
                    return;
                }

                const apiUrl = `https://db.ygoprodeck.com/api/v7/cardinfo.php?name=${encodeURIComponent(cardName)}`;
                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error(`API returned status: ${response.status}`);
                    const data = await response.json();
                    const cardInfo = data?.data?.[0];
                    
                    if (cardInfo) {
                        cardDataCache[cardName] = cardInfo;
                        displayCardImage(cardInfo, container);
                    } else {
                        throw new Error("Card data not found in API response.");
                    }
                } catch (error) {
                    console.error(`Failed to fetch data for "${cardName}":`, error);
                    container.innerHTML = `<div class="card-placeholder animate-fadeIn">${cardName}</div>`;
                }
            }

            function displayCardImage(cardInfo, container) {
                 const imageUrl = cardInfo.card_images?.[0]?.image_url;
                 if (imageUrl) {
                    const img = document.createElement('img');
                    img.src = imageUrl;
                    img.alt = cardInfo.name;
                    img.className = 'w-full h-auto rounded-lg shadow-md animate-fadeIn';
                    container.innerHTML = '';
                    container.appendChild(img);
                } else {
                     container.innerHTML = `<div class="card-placeholder animate-fadeIn">${cardInfo.name}</div>`;
                }
            }
            
            function showPopup(event, cardName) {
                event.stopPropagation();
                if (!popup) return;
                const cardInfo = cardDataCache[cardName];
                if (!cardInfo) return;

                let stats = '';
                let atkDef = [];
                if (cardInfo.atk !== undefined) atkDef.push(`ATK/${cardInfo.atk}`);
                if (cardInfo.def !== undefined) atkDef.push(`DEF/${cardInfo.def}`);
                if (cardInfo.linkval) atkDef.push(`LINK-${cardInfo.linkval}`);
                if(atkDef.length > 0) {
                    stats = `<p class="stats">${atkDef.join(' ')}</p>`;
                }
                
                const cardType = cardInfo.type.includes('Monster') ? `[${cardInfo.race} / ${cardInfo.type.replace(' Monster', '')}]` : `[${cardInfo.race} Card]`;

                popup.innerHTML = `
                    <img src="${cardInfo.card_images?.[0]?.image_url}" alt="${cardInfo.name}">
                    <h3>${cardInfo.name}</h3>
                    <p class="type">${cardType}</p>
                    <p>${cardInfo.desc.replace(/\r\n/g, '<br>')}</p>
                    ${stats}
                `;
                
                movePopup(event);
                popup.classList.add('show');
                activePopup = popup;
            }

            function hidePopup() {
                if (activePopup) {
                    activePopup.classList.remove('show');
                    activePopup = null;
                }
            }

            function movePopup(event) {
                if (!popup) return;
                const popupWidth = 400;
                const popupHeight = 600;
                const cushion = 20;

                let x = event.clientX + cushion;
                let y = event.clientY + cushion;

                if (x + popupWidth > window.innerWidth) {
                    x = event.clientX - popupWidth - cushion;
                }
                if (y + popupHeight > window.innerHeight) {
                    y = event.clientY - popupHeight - cushion;
                }

                popup.style.left = `${x}px`;
                popup.style.top = `${y}px`;
            }

            // Global click listener to close the popup
            document.addEventListener('click', (event) => {
                if (activePopup && !activePopup.contains(event.target)) {
                    hidePopup();
                }
            });

            // Mouse move listener for popup positioning
            document.addEventListener('mousemove', (event) => {
                if (activePopup) {
                    movePopup(event);
                }
            });

            const cardsToLoad = {
                'catty-img-container': 'Melffy Catty',
                'puppy-img-container': 'Melffy Puppy',
                'wally-img-container': 'Melffy Wally',
            };

            for (const [containerId, cardName] of Object.entries(cardsToLoad)) {
                fetchAndProcessCardData(cardName, containerId);
                // Add click event listener to the container
                const container = document.getElementById(containerId);
                if (container) {
                    container.addEventListener('click', (event) => {
                        event.stopPropagation();
                        if (activePopup && activePopup === popup) {
                            hidePopup();
                        } else {
                            showPopup(event, cardName);
                        }
                    });
                }
            }
            // Banlist Check - Kashtira style
            const keyCards = [
                "Melffy Catty", "Melffy Puppy", "Melffy Wally", "Rescue Cat", "Obedience Schooled", 
                "Spright Blue", "Spright Jet", "Spright Starter", "Tri-Brigade Fraktall", "Tri-Brigade Kerass", 
                "Tri-Brigade Nervall", "Tri-Brigade Revolt", "Spright Elf"
            ];
            async function checkBanlist() {
                try {
                    const response = await fetch('https://db.ygoprodeck.com/api/v7/cardinfo.php?banlist=tcg');
                    const data = await response.json();
                    const banlist = data.data;
                    const forbiddenList = document.getElementById('melffy-banlist-forbidden');
                    const unrestrictedList = document.getElementById('melffy-banlist-unrestricted');
                    const metaDiv = document.getElementById('melffy-banlist-meta');
                    let forbiddenHtml = '';
                    let unrestrictedHtml = '';
                    let forbiddenCount = 0;
                    let limitedCount = 0;
                    let limitedNames = [];
                    keyCards.forEach(cardName => {
                        const card = banlist.find(c => c.name === cardName);
                        if (card && card.banlist_info && card.banlist_info.ban_tcg) {
                            switch (card.banlist_info.ban_tcg) {
                                case 'Forbidden':
                                    forbiddenHtml += `<li><strong class="text-red-500">${cardName} (0 copies)</strong></li>`;
                                    forbiddenCount++;
                                    break;
                                case 'Limited':
                                    forbiddenHtml += `<li><strong class="text-yellow-500">${cardName} (1 copy)</strong></li>`;
                                    limitedCount++;
                                    limitedNames.push(cardName);
                                    break;
                                case 'Semi-Limited':
                                    forbiddenHtml += `<li><strong class="text-blue-500">${cardName} (2 copies)</strong></li>`;
                                    break;
                            }
                        } else {
                            unrestrictedHtml += `<li><strong class="text-green-500">${cardName} (3 copies)</strong></li>`;
                        }
                    });
                    if (!forbiddenHtml) forbiddenHtml = '<li><strong class="text-green-500">No key cards forbidden or limited</strong></li>';
                    if (!unrestrictedHtml) unrestrictedHtml = '<li><strong class="text-red-500">No unrestricted key cards</strong></li>';
                    forbiddenList.innerHTML = forbiddenHtml;
                    unrestrictedList.innerHTML = unrestrictedHtml;
                    // Meta implications
                    let metaText = '<strong>Meta Implications:</strong> ';
                    if (forbiddenCount > 0) {
                        metaText += 'Melffy loses access to some of its core combo pieces, reducing its ability to disrupt and swarm. ';
                    }
                    if (limitedCount > 0) {
                        metaText += `Key cards like ${limitedNames.join(', ')} are limited, impacting consistency and combo potential. `;
                    }
                    if (forbiddenCount === 0 && limitedCount === 0) {
                        metaText += 'Melffy remains fully operational, with all major combo pieces and support engines available at full power.';
                    }
                    metaDiv.innerHTML = metaText;
                } catch (error) {
                    document.getElementById('melffy-banlist-forbidden').innerHTML = '<li class="text-red-500">Could not load banlist information.</li>';
                    document.getElementById('melffy-banlist-unrestricted').innerHTML = '';
                    document.getElementById('melffy-banlist-meta').innerHTML = '<strong>Meta Implications:</strong> Banlist data unavailable.';
                }
            }
            checkBanlist();
        });
    </script>
    <div id="card-popup" class="popup"></div>
</body>
</html>


