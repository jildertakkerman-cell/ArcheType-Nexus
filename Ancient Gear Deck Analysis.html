<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ancient Gear</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="assets/js/card-loader.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #3d2c1d; /* Rusty brown background */
            color: #e3dcd2; /* Aged parchment text */
        }
        .container {
            max-width: 1024px;
        }
        .card {
            background-color: #5c432c; /* Darker wood/metal color */
            border-radius: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            border: 1px solid #7c6248;
        }
        .combo-step-card {
            background-color: #4a3622;
            border: 1px solid #6b5037;
        }
        .pro-con-card {
            background-color: #4a3622;
            border: 1px solid #6b5037;
        }
        .card-image {
            width: 100%;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-in-out;
        }
        .card-placeholder {
            background-color: #4a3622;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 0.75rem;
            line-height: 1rem;
            font-weight: bold;
            height: 100%;
            min-height: 128px;
            border-radius: 0.5rem;
            padding: 0.5rem;
            box-shadow: 0 0 10px #4a3622;
        }
        .pro-icon { color: #4ade80; }
        .con-icon { color: #ef4444; }
        .neutral-icon { color: #60a5fa; }
        .text-accent { color: #c89c6d; } /* Bronze/Gear color */
        .arrow-color { color: #c89c6d; }
        .heading-underline {
            border-bottom: 2px solid #c89c6d;
            display: inline-block;
            padding-bottom: 0.25rem;
        }

        /* --- NEW ANIMATED BANNER STYLES --- */
        .banner-header {
            position: relative;
            min-height: 160px; /* Matching Battlewasp size */
            background-color: #2b1f15; /* Dark, greasy machine color */
            border-radius: 1rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            margin-bottom: 2.5rem;
            border: 1px solid #7c6248;
        }

        #gear-banner {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.7; /* Increased opacity for better visibility */
        }

        .banner-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle, rgba(43,31,21,0.5) 0%, rgba(43,31,21,0.9) 80%);
            z-index: 2;
        }

        .banner-header h1, .banner-header p {
            position: relative;
            z-index: 3;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
        }

        @media (min-width: 768px) {
            .banner-header {
                margin-bottom: 4rem;
            }
        }
        /* --- END OF BANNER STYLES --- */
                    /* --- Yu-Gi-Oh! Themed Home Button Styles --- */
        .ygo-home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%);
            color: white;
            border: 2px solid #6366f1;
            border-radius: 12px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 4px 15px rgba(99, 102, 241, 0.4),
                0 0 20px rgba(99, 102, 241, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            overflow: hidden;
        }
        
        .ygo-home-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(99, 102, 241, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(139, 92, 246, 0.2) 0%, transparent 50%);
            animation: ygoButtonPulse 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        .ygo-home-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 8px 25px rgba(99, 102, 241, 0.6),
                0 0 30px rgba(99, 102, 241, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: #8b5cf6;
        }
        
        .ygo-home-button:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        .ygo-home-button i {
            font-size: 22px;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 10px rgba(99, 102, 241, 0.8);
            animation: ygoIconGlow 2s ease-in-out infinite alternate;
        }
        
        .ygo-home-button .ygo-home-text {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 600;
            color: #a5b4fc;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
            pointer-events: none;
        }
        
        .ygo-home-button:hover .ygo-home-text {
            opacity: 1;
        }
        
        @keyframes ygoButtonPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        @keyframes ygoIconGlow {
            0% { 
                text-shadow: 
                    0 0 10px rgba(99, 102, 241, 0.8),
                    0 0 20px rgba(139, 92, 246, 0.4);
            }
            100% { 
                text-shadow: 
                    0 0 15px rgba(99, 102, 241, 1),
                    0 0 30px rgba(139, 92, 246, 0.6),
                    0 0 40px rgba(59, 130, 246, 0.3);
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .ygo-home-button {
                width: 50px;
                height: 50px;
                top: 15px;
                left: 15px;
            }
            
            .ygo-home-button i {
                font-size: 18px;
            }
        }
        #card-popup h3 {
            color: #c89c6d;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        #card-popup p {
            margin: 0.25rem 0;
        }
        #card-popup-stats {
            color: #c89c6d;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Yu-Gi-Oh! Themed Home Button -->
    <a href="index-refactored.html" class="ygo-home-button" title="Return to Archetype Nexus">
        <i class="fas fa-home"></i>
        <span class="ygo-home-text">NEXUS</span>
    </a>

<div class="container mx-auto">
        <!-- MODIFIED Title Section -->
        <header class="banner-header text-center">
            <canvas id="gear-banner"></canvas>
            <h1 class="text-3xl md:text-5xl font-extrabold text-white mb-2 heading-underline">Ancient Gear</h1>
            <p class="text-lg md:text-xl text-yellow-100">An Analysis of the Mechanical OTK Strategy</p>
        </header>

        <!-- Executive Summary Section -->
        <section class="mb-10 md:mb-16">
            <div class="card p-6">
                <h2 class="text-xl md:text-2xl font-bold text-white mb-4">Executive Summary</h2>
                <p class="text-yellow-100">
                    The <strong class="text-accent font-bold">Ancient Gear</strong> archetype is a historic, battle-focused strategy designed to achieve a swift One-Turn Kill (OTK). Its core identity is defined by a shared passive effect: when an "Ancient Gear" monster attacks, the opponent cannot activate Spells or Traps until the end of the Damage Step. This provides powerful battle protection, allowing the deck to commit to aggressive plays. Originally a slow, Tribute-based deck, modern support has transformed it into an explosive, consistent Fusion-based strategy that aims to quickly summon a massive boss monster to end the game.
                </p>
            </div>
        </section>
        
        <!-- Foundational Mechanics Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Foundational Mechanics</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-white mb-2">Battle Phase Lockdown</h3>
                    <p class="text-yellow-100">The archetype's signature ability prevents opponents from responding to attacks with Spell or Trap cards, neutralizing common threats and ensuring attacks connect.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-white mb-2">Explosive Fusion Summoning</h3>
                    <p class="text-yellow-100">With powerful spells like <strong class="text-accent font-bold">Ancient Gear Fusion</strong>, the deck can use materials directly from the deck, bypassing the need to have all combo pieces in hand and rapidly accelerating into its boss monsters.</p>
                </div>
            </div>
        </section>

        <!-- Core Combo Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Core Combo: The Wyvern One-Card OTK Setup</h2>
            <p class="text-yellow-100 mb-8 text-center max-w-2xl mx-auto">A single <strong class="text-accent font-bold">Ancient Gear Wyvern</strong> can initiate a linear sequence of searches to generate an overwhelming board presence for a lethal strike.</p>
            <div class="flex flex-col items-center gap-6">
                <!-- Step 1 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="wyvern-img-container" class="w-32 md:w-40 flex-shrink-0"></div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#3d2c1d] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">1</span>
                            <h3 class="text-lg font-bold">The Initial Search</h3>
                        </div>
                        <p class="text-yellow-100">Normal Summon <strong class="text-accent font-bold">Ancient Gear Wyvern</strong> to search <strong class="text-accent font-bold">Ancient Gear Box</strong>, which then triggers to search for <strong class="text-accent font-bold">Ancient Gear Frame</strong>.</p>
                    </div>
                </div>
                <!-- Arrow -->
                <div class="w-full flex justify-center">
                    <svg class="h-10 w-10 arrow-color animate-fadeIn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                    </svg>
                </div>
                <!-- Step 2 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="ballista-img-container" class="w-32 md:w-40 flex-shrink-0"></div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#3d2c1d] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">2</span>
                            <h3 class="text-lg font-bold">Link into the Hub</h3>
                        </div>
                        <p class="text-yellow-100">Link Summon <strong class="text-accent font-bold">Ancient Gear Ballista</strong> using Wyvern. Ballista's effect then searches for <strong class="text-accent font-bold">Geartown</strong>.</p>
                    </div>
                </div>
                <!-- Arrow -->
                <div class="w-full flex justify-center">
                    <svg class="h-10 w-10 arrow-color animate-fadeIn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                    </svg>
                </div>
                <!-- Step 3 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="golem-img-container" class="w-32 md:w-40 flex-shrink-0"></div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#3d2c1d] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">3</span>
                            <h3 class="text-lg font-bold">Swarm the Field</h3>
                        </div>
                        <p class="text-yellow-100">Use <strong class="text-accent font-bold">Ancient Gear Catapult</strong> to destroy <strong class="text-accent font-bold">Geartown</strong>, triggering both effects to Special Summon multiple <strong class="text-accent font-bold">Ancient Gear Golems</strong> from the deck.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Final Endboard Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">The Final Endboard: The Chaos Giant OTK</h2>
            <p class="text-yellow-100 mb-8 text-center max-w-2xl mx-auto">The typical endboard is not a defensive wall, but a singular, devastating offensive threat designed to end the game immediately.</p>
            <div class="card p-6 flex flex-col md:flex-row items-center md:items-start gap-4 mx-auto max-w-2xl">
                <div class="flex flex-col items-center gap-4">
                    <div id="chaos-giant-img-container" class="w-32 md:w-40 flex-shrink-0"></div>
                </div>
                <div>
                    <ul class="list-disc list-inside space-y-2 text-yellow-100">
                        <li><strong class="text-accent font-bold">Chaos Ancient Gear Giant:</strong> A 4500 ATK behemoth that is unaffected by Spell/Trap effects and prevents the opponent from activating monster effects during the Battle Phase.</li>
                        <li><strong class="text-accent font-bold">Multiple Attacks:</strong> It can attack all of your opponent's monsters once each, clearing the entire board.</li>
                        <li><strong class="text-accent font-bold">Piercing Damage:</strong> Inflicts piercing battle damage, ensuring massive damage even against defense position monsters.</li>
                        <li><strong class="text-accent font-bold">OTK Potential:</strong> Often combined with cards like <strong class="text-accent font-bold">Power Bond</strong> or <strong class="text-accent font-bold">Number 60: Dugares the Timeless</strong> to double its ATK to 9000 for a decisive final blow.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Pros, Cons, and Tech Cards Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Competitive Analysis</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-green-400 mb-4">Strengths</h3>
                    <ul class="list-disc list-inside space-y-2 text-yellow-100">
                        <li><span class="pro-icon"><i class="fas fa-check-circle"></i></span> <strong class="text-green-400 font-bold">High Consistency:</strong> Multiple searchers create a streamlined, reliable combo.</li>
                        <li><span class="pro-icon"><i class="fas fa-bolt"></i></span> <strong class="text-green-400 font-bold">Powerful OTK Potential:</strong> Capable of ending the game in a single Battle Phase.</li>
                        <li><span class="pro-icon"><i class="fas fa-shield-alt"></i></span> <strong class="text-green-400 font-bold">Battle Protection:</strong> Immune to common battle-phase Spell/Trap disruptions.</li>
                    </ul>
                </div>
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-red-400 mb-4">Weaknesses</h3>
                    <ul class="list-disc list-inside space-y-2 text-yellow-100">
                        <li><span class="con-icon"><i class="fas fa-times-circle"></i></span> <strong class="text-red-400 font-bold">Vulnerable to Hand Traps:</strong> Key search effects are easily disrupted by monster effect negation.</li>
                        <li><span class="con-icon"><i class="fas fa-ban"></i></span> <strong class="text-red-400 font-bold">Linear Strategy:</strong> The combo is predictable and can be stopped at key choke points.</li>
                         <li><span class="con-icon"><i class="fas fa-arrow-down"></i></span> <strong class="text-red-400 font-bold">"Go-Second" Reliance:</strong> Struggles to build a resilient board when forced to go first.</li>
                    </ul>
                </div>
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-white mb-4">Key Synergies & Support</h3>
                    <ul class="list-disc list-inside space-y-2 text-yellow-100">
                        <li><span class="neutral-icon"><i class="fas fa-cogs"></i></span> <strong class="text-accent font-bold">Gadget Engine:</strong> Provides a consistent stream of monsters for Fusion and Link plays.</li>
                        <li><span class="neutral-icon"><i class="fas fa-copy"></i></span> <strong class="text-accent font-bold">Machine Duplication:</strong> Turns a single <strong class="text-accent font-bold">Ancient Gear Box</strong> into three monsters for explosive combos.</li>
                        <li><span class="neutral-icon"><i class="fas fa-plus-circle"></i></span> <strong class="text-accent font-bold">Power Bond:</strong> A high-risk, high-reward Fusion Spell that doubles the ATK of the summoned monster.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Card Overview Section -->
        <section>
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">The Ancient Gear Arsenal</h2>
            <p class="text-yellow-100 mb-8 text-center max-w-2xl mx-auto">A detailed overview of the key machines and their powerful support.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Ancient Gear Wyvern</h3>
                    <p class="text-yellow-100">The primary searcher. On summon, it can add any "Ancient Gear" card from the deck to the hand.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Ancient Gear Catapult</h3>
                    <p class="text-yellow-100">A key combo Spell. Destroys a face-up card to Special Summon an "Ancient Gear" monster from the deck, ignoring its summoning conditions.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Ancient Gear Ballista</h3>
                    <p class="text-yellow-100">The Link-1 combo hub. On summon, it searches for any "Ancient Gear" card or "Geartown".</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Ancient Gear Fusion</h3>
                    <p class="text-yellow-100">A powerful Fusion Spell that can use materials from the deck if <strong class="text-accent font-bold">Ancient Gear Golem</strong> is on the field.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Chaos Ancient Gear Giant</h3>
                    <p class="text-yellow-100">The ultimate boss monster. A 4500 ATK behemoth that can attack all opponent's monsters and is immune to most effects during battle.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-accent mb-2">Geartown</h3>
                    <p class="text-yellow-100">A Field Spell that can Special Summon an "Ancient Gear" monster from the hand, deck, or graveyard when destroyed.</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
             // --- ANCIENT GEAR "CLOCKWORK ENGINE" ANIMATION ---
            const canvas = document.getElementById('gear-banner');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let gears = [];
                let animationFrameId;

                const setCanvasSize = () => {
                    canvas.width = canvas.offsetWidth;
                    canvas.height = canvas.offsetHeight;
                };

                class Gear {
                    constructor(x, y, radius, teeth, speed, color) {
                        this.x = x;
                        this.y = y;
                        this.radius = radius;
                        this.teeth = teeth;
                        this.speed = speed;
                        this.color = color;
                        this.angle = Math.random() * Math.PI * 2;
                    }

                    update() {
                        this.angle += this.speed;
                    }

                    draw() {
                        const toothSize = this.radius * 0.2;
                        ctx.save();
                        ctx.translate(this.x, this.y);
                        ctx.rotate(this.angle);

                        ctx.beginPath();
                        for (let i = 0; i < this.teeth; i++) {
                            const angle = (i / this.teeth) * Math.PI * 2;
                            const x1 = Math.cos(angle) * (this.radius - toothSize / 2);
                            const y1 = Math.sin(angle) * (this.radius - toothSize / 2);
                            const x2 = Math.cos(angle) * (this.radius + toothSize / 2);
                            const y2 = Math.sin(angle) * (this.radius + toothSize / 2);
                            
                            const nextAngle = ((i + 0.5) / this.teeth) * Math.PI * 2;
                             const x3 = Math.cos(nextAngle) * (this.radius + toothSize / 2);
                            const y3 = Math.sin(nextAngle) * (this.radius + toothSize / 2);


                            ctx.moveTo(x1, y1);
                            ctx.lineTo(x2, y2);
                            ctx.lineTo(x3, y3);
                        }
                        ctx.closePath();
                        
                        ctx.fillStyle = this.color;
                        ctx.fill();

                        // Inner circle
                        ctx.beginPath();
                        ctx.arc(0, 0, this.radius * 0.5, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(43, 31, 21, 0.8)`; // Center color
                        ctx.fill();
                        
                        ctx.restore();
                    }
                }

                function init() {
                    gears = [];
                    // Increased opacity in gear colors
                    const gearColors = ['rgba(200, 156, 109, 0.4)', 'rgba(124, 98, 72, 0.4)', 'rgba(92, 60, 44, 0.4)'];
                    const gearCount = Math.floor((canvas.width * canvas.height) / 20000);
                    
                    for (let i = 0; i < gearCount; i++) {
                        const radius = Math.random() * 40 + 20;
                        const x = Math.random() * canvas.width;
                        const y = Math.random() * canvas.height;
                        const teeth = Math.floor(radius / 3);
                        const speed = (Math.random() - 0.5) * 0.01;
                        const color = gearColors[Math.floor(Math.random() * gearColors.length)];
                        gears.push(new Gear(x, y, radius, teeth, speed, color));
                    }
                }

                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    gears.forEach(gear => {
                        gear.update();
                        gear.draw();
                    });
                    animationFrameId = requestAnimationFrame(animate);
                }
                
                function startAnimation() {
                    if (animationFrameId) {
                        cancelAnimationFrame(animationFrameId);
                    }
                    setCanvasSize();
                    init();
                    animate();
                }

                startAnimation();
                window.addEventListener('resize', startAnimation);
            }

            // --- CARD POPUP AND IMAGE FETCHER SCRIPT ---

            const cardDataCache = {};
            const popup = document.getElementById('card-popup');
            let activePopup = null;

            async function fetchAndProcessCardData(cardName, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                
                const apiUrl = `https://db.ygoprodeck.com/api/v7/cardinfo.php?name=${encodeURIComponent(cardName)}`;

                try {
                    if (cardDataCache[cardName]) {
                        displayCardImage(cardDataCache[cardName], container);
                        return;
                    }
                    
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error(`API error: ${response.status}`);
                    const data = await response.json();
                    const cardInfo = data?.data?.[0];
                    
                    if (cardInfo) {
                        cardDataCache[cardName] = cardInfo;
                        displayCardImage(cardInfo, container);
                    } else {
                        throw new Error("Card data not found in API response.");
                    }
                } catch (error) {
                    console.error(`Failed to fetch data for "${cardName}":`, error);
                    container.innerHTML = `<div class="card-placeholder animate-fadeIn">${cardName}</div>`;
                }
            }

            function displayCardImage(cardInfo, container) {
                 const imageUrl = cardInfo.card_images?.[0]?.image_url;
                 if (imageUrl) {
                    const img = document.createElement('img');
                    img.src = imageUrl;
                    img.alt = cardInfo.name;
                    img.className = 'w-full h-auto rounded-lg shadow-md animate-fadeIn';
                    img.addEventListener('click', (event) => {
                        event.stopPropagation();
                        showPopup(event, cardInfo.name);
                    });
                    container.innerHTML = '';
                    container.appendChild(img);
                } else {
                     container.innerHTML = `<div class="card-placeholder animate-fadeIn">${cardInfo.name}</div>`;
                }
            }
            
            function showPopup(event, cardName) {
                if (!popup) return;
                const cardInfo = cardDataCache[cardName];
                if (!cardInfo) return;

                let stats = '';
                let atkDef = [];
                if (cardInfo.atk !== undefined) atkDef.push(`ATK/${cardInfo.atk}`);
                if (cardInfo.def !== undefined) atkDef.push(`DEF/${cardInfo.def}`);
                if (cardInfo.linkval) atkDef.push(`LINK-${cardInfo.linkval}`);
                if(atkDef.length > 0) {
                    stats = `<p id="card-popup-stats" class="mt-2">${atkDef.join(' ')}</p>`;
                }
                
                const cardType = cardInfo.type.includes('Monster') ? `[${cardInfo.race} / ${cardInfo.type.replace(' Monster', '')}]` : `[${cardInfo.race} Card]`;

                popup.innerHTML = `
                    <div>
                        <h3>${cardInfo.name}</h3>
                        <p class="text-xs text-blue-300">${cardType}</p>
                        <div class="w-full h-px bg-blue-700 my-2"></div>
                        <p class="text-xs">${cardInfo.desc.replace(/\r\n/g, '<br>')}</p>
                        ${stats}
                    </div>
                `;
                
                movePopup(event);
                popup.style.display = 'block';
                setTimeout(() => { popup.style.opacity = 1; }, 10);
                activePopup = popup;
            }

            function hidePopup() {
                if (activePopup) {
                    activePopup.style.opacity = 0;
                    setTimeout(() => { 
                        if (activePopup) activePopup.style.display = 'none'; 
                    }, 200);
                    activePopup = null;
                }
            }

            function movePopup(event) {
                if (!popup) return;
                const popupWidth = popup.offsetWidth;
                const popupHeight = popup.offsetHeight;
                const cushion = 20;

                let x = event.clientX + cushion;
                let y = event.clientY + cushion;

                if (x + popupWidth > window.innerWidth) {
                    x = event.clientX - popupWidth - cushion;
                }
                if (y + popupHeight > window.innerHeight) {
                    y = event.clientY - popupHeight - cushion;
                }

                popup.style.left = `${x}px`;
                popup.style.top = `${y}px`;
            }

            // Global click listener to close the popup
            document.addEventListener('click', hidePopup);

            async function fetchAndDisplayCardImage(cardName, containerId) {
                fetchAndProcessCardData(cardName, containerId);
            }

            fetchAndDisplayCardImage('Ancient Gear Wyvern', 'wyvern-img-container');
            fetchAndDisplayCardImage('Ancient Gear Ballista', 'ballista-img-container');
            fetchAndDisplayCardImage('Ancient Gear Golem', 'golem-img-container');
            fetchAndDisplayCardImage('Chaos Ancient Gear Giant', 'chaos-giant-img-container');
        });
    </script>
    <div id="card-popup" class="fixed z-50 bg-gray-900 border-2 border-[#c89c6d] text-white p-4 rounded-lg shadow-lg max-w-xs opacity-0 transition-opacity duration-200 pointer-events-none"></div>
</body>
</html>




