<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bystial Archetype Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c0a09; /* Near-black */
            color: #d1d5db; /* Cool Gray */
        }
        .container {
            max-width: 1024px;
        }
        .card {
            background-color: #1f1d1b; /* Very dark gray */
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            border: 1px solid #7e22ce; /* Vibrant Purple Border */
        }
        .combo-step-card {
            background-color: #282524; /* Darker Gray */
            border: 1px solid #a855f7; /* Lighter Purple Accent */
        }
        .pro-con-card {
            background-color: #282524;
            border: 1px solid #a855f7;
        }
        .card-placeholder {
            background-color: #1f1d1b;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 0.75rem;
            line-height: 1rem;
            font-weight: bold;
            height: 100%;
            min-height: 128px;
            border-radius: 0.5rem;
            padding: 0.5rem;
            box-shadow: 0 0 10px #1f1d1b;
            cursor: pointer;
        }
        .icon-glow {
            filter: drop-shadow(0 0 8px #7e22ce);
        }
        .pro-icon { color: #34d399; }
        .con-icon { color: #ef4444; }
        .neutral-icon { color: #60a5fa; }
        .text-accent { color: #c084fc; }
        .arrow-color { color: #a855f7; }
        .heading-underline {
            border-bottom: 2px solid #a855f7;
            display: inline-block;
            padding-bottom: 0.25rem;
        }
        a.lore-link {
            color: #d1d5db;
            text-decoration: underline;
            transition: color 0.3s;
        }
        a.lore-link:hover { color: #c084fc; }

        /* --- NEW BYSTIAL BANNER STYLES --- */
        .banner-header {
            position: relative;
            min-height: 160px;
            background-color: #0c0a09;
            border-radius: 1rem;
            border: 1px solid #7e22ce;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            margin-bottom: 2.5rem;
            box-shadow: 0 0 20px rgba(126, 34, 206, 0.3);
        }

        #chaos-banner {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .banner-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(12, 10, 9, 0.75); /* Semi-transparent overlay */
            z-index: 2;
        }

        .banner-header h1, .banner-header p {
            position: relative;
            z-index: 3;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.9);
        }
        /* --- END OF BANNER STYLES --- */
                    /* --- Yu-Gi-Oh! Themed Home Button Styles --- */
        .ygo-home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%);
            color: white;
            border: 2px solid #6366f1;
            border-radius: 12px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 4px 15px rgba(99, 102, 241, 0.4),
                0 0 20px rgba(99, 102, 241, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            overflow: hidden;
        }
        
        .ygo-home-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(99, 102, 241, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(139, 92, 246, 0.2) 0%, transparent 50%);
            animation: ygoButtonPulse 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        .ygo-home-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 8px 25px rgba(99, 102, 241, 0.6),
                0 0 30px rgba(99, 102, 241, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: #8b5cf6;
        }
        
        .ygo-home-button:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        .ygo-home-button i {
            font-size: 22px;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 10px rgba(99, 102, 241, 0.8);
            animation: ygoIconGlow 2s ease-in-out infinite alternate;
        }
        
        .ygo-home-button .ygo-home-text {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 600;
            color: #a5b4fc;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
            pointer-events: none;
        }
        
        .ygo-home-button:hover .ygo-home-text {
            opacity: 1;
        }
        
        @keyframes ygoButtonPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        @keyframes ygoIconGlow {
            0% { 
                text-shadow: 
                    0 0 10px rgba(99, 102, 241, 0.8),
                    0 0 20px rgba(139, 92, 246, 0.4);
            }
            100% { 
                text-shadow: 
                    0 0 15px rgba(99, 102, 241, 1),
                    0 0 30px rgba(139, 92, 246, 0.6),
                    0 0 40px rgba(59, 130, 246, 0.3);
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .ygo-home-button {
                width: 50px;
                height: 50px;
                top: 15px;
                left: 15px;
            }
            
            .ygo-home-button i {
                font-size: 18px;
            }
        }
        #card-popup {
            background-color: #1f1d1b;
            border-color: #7e22ce;
            color: #d1d5db;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
        }
        #card-popup h3 {
            color: #a855f7;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        #card-popup p {
            margin-bottom: 0.5rem;
        }
        #card-popup-stats {
            color: #a855f7;
            font-weight: bold;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Yu-Gi-Oh! Themed Home Button -->
    <a href="index-refactored.html" class="ygo-home-button" title="Return to Archetype Nexus">
        <i class="fas fa-home"></i>
        <span class="ygo-home-text">NEXUS</span>
    </a>

    <!-- Card Popup -->
    <div id="card-popup" class="fixed z-50 bg-purple-900 border-2 border-purple-600 text-white p-4 rounded-lg shadow-lg max-w-xs max-h-96 overflow-y-auto opacity-0 transition-opacity duration-200 pointer-events-none"></div>

<div class="container mx-auto">
        <!-- New Animated Banner Section -->
        <header class="banner-header text-center">
            <canvas id="chaos-banner"></canvas>
            <h1 class="text-3xl md:text-5xl font-extrabold text-white mb-2 heading-underline">Bystial</h1>
            <p class="text-lg md:text-xl text-purple-200">Analysis of a Chaos-Attribute Disruption Engine</p>
        </header>

        <!-- Executive Summary Section -->
        <section class="mb-10 md:mb-16">
            <div class="card p-6">
                <h2 class="text-xl md:text-2xl font-bold text-white mb-4">Executive Summary</h2>
                <p class="text-gray-300">
                    The <strong class="text-accent font-bold">Bystial</strong> archetype is a specialized engine of Level 6 and 8 DARK Dragon monsters that thrive on chaos by interacting with LIGHT and DARK attributes. Introduced as a powerful anti-meta force, their core mechanic allows them to be Special Summoned from the hand as a Quick Effect by banishing a LIGHT or DARK monster from either player's Graveyard. This turns them into potent, reusable hand traps that disrupt the opponent while building your own board presence. Their deep integration with the <a href="https://yugipedia.com/wiki/Abyss_(story)" target="_blank" rel="noopener noreferrer" class="lore-link">"Abyss" storyline</a> via "Branded" support transforms them from simple disruption into a relentless, resource-generating engine.
                </p>
            </div>
        </section>

        <!-- Foundational Mechanics Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Foundational Mechanics: The Bystial Paradigm</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-white mb-2"><i class="fas fa-ghost text-accent mr-2"></i>Chaos Summons</h3>
                    <p class="text-gray-300">The defining trait of the Level 6 Bystials. By banishing a LIGHT or DARK monster from any Graveyard, they can Special Summon themselves. This becomes a Quick Effect if the opponent controls a monster, making them formidable interruptions.</p>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-white mb-2"><i class="fas fa-recycle text-accent mr-2"></i>Branded Synergy</h3>
                    <p class="text-gray-300">The engine's longevity comes from its synergy with "Branded" Continuous Spells/Traps. <strong class="text-accent font-bold">The Bystial Lubellion</strong> searches and places cards like <strong class="text-accent font-bold">Branded Regained</strong>, creating a loop of drawing, revival, and control.</p>
                </div>
            </div>
        </section>

        <!-- Core Combo Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Core Combo: Branded Bystial Fusion Line</h2>
            <p class="text-gray-300 mb-8 text-center max-w-2xl mx-auto">This walkthrough showcases how a Branded starter and a Bystial extender can create a multi-layered board.</p>
            <div class="flex flex-col items-center gap-6">
                <!-- Step 1 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="aluber-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">Aluber the Jester of Despia</div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#1f1d1b] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">1</span>
                            <h3 class="text-lg font-bold">The Branded Start</h3>
                        </div>
                        <p class="text-gray-300">Normal Summon <strong class="text-accent font-bold">Aluber the Jester of Despia</strong> to search <strong class="text-orange-400">Branded Fusion</strong> <span class="text-orange-400">(semi-limited to 2)</span>. Activate it to summon a Fusion monster like <strong class="text-accent font-bold">Rindbrumm the Striking Dragon</strong>, sending materials from the deck.</p>
                    </div>
                </div>
                <!-- Arrow -->
                <div class="w-full flex justify-center">
                    <svg class="h-10 w-10 arrow-color animate-fadeIn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                    </svg>
                </div>
                <!-- Step 2 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="magnamhut-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">Bystial Magnamhut</div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#1f1d1b] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">2</span>
                            <h3 class="text-lg font-bold">The Bystial Interruption</h3>
                        </div>
                        <p class="text-gray-300">Special Summon a Bystial like <strong class="text-accent font-bold">Bystial Magnamhut</strong> by banishing a LIGHT/DARK monster from a GY. This puts another body on board and sets up an End Phase search for a Dragon.</p>
                    </div>
                </div>
                <!-- Arrow -->
                <div class="w-full flex justify-center">
                    <svg class="h-10 w-10 arrow-color animate-fadeIn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                    </svg>
                </div>
                <!-- Step 3 -->
                <div class="card p-6 combo-step-card w-full max-w-md flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div id="lubellion-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">The Bystial Lubellion</div>
                    <div>
                        <div class="flex items-center mb-2">
                            <span class="bg-[#1f1d1b] text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">3</span>
                            <h3 class="text-lg font-bold">The Engine Hub</h3>
                        </div>
                        <p class="text-gray-300">Tribute a Dragon to summon <strong class="text-accent font-bold">The Bystial Lubellion</strong>. Its effect places <strong class="text-accent font-bold">Branded Regained</strong> on the field, establishing the powerful recursion loop for the rest of the duel.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Endboard Analysis Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Endboard Analysis: A Multi-Layered Defense</h2>
            <p class="text-gray-300 mb-8 text-center max-w-2xl mx-auto">The ideal Bystial endboard is not a single towering monster, but a resilient, multi-layered field that provides disruption, negation, and resource generation to outlast the opponent.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mx-auto max-w-6xl">
                <!-- Mirrorjade -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-white mb-4 text-center">Mirrorjade the Iceblade Dragon</h3>
                    <div class="flex justify-center mb-4">
                        <div id="mirrorjade-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">Mirrorjade the Iceblade Dragon</div>
                    </div>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><strong class="text-accent font-bold">Non-Targeting Banish:</strong> A powerful Quick Effect to banish any monster on the field.</li>
                        <li><strong class="text-accent font-bold">Board Wipe Insurance:</strong> When it leaves the field by an opponent's card, it destroys all monsters they control during the End Phase.</li>
                    </ul>
                </div>
                <!-- Rindbrumm -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-white mb-4 text-center">Rindbrumm the Striking Dragon</h3>
                    <div class="flex justify-center mb-4">
                        <div id="rindbrumm-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">Rindbrumm the Striking Dragon</div>
                    </div>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><strong class="text-accent font-bold">Monster Negation:</strong> A Quick Effect to negate the activation of an opponent's monster effect.</li>
                        <li><strong class="text-accent font-bold">Follow-up Synergy:</strong> Can Fusion Summon during the opponent's turn, providing further disruption and extension.</li>
                    </ul>
                </div>
                <!-- Bystial Dis Pater -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-white mb-4 text-center">Bystial Dis Pater</h3>
                    <div class="flex justify-center mb-4">
                        <div id="dispater-img-container" class="w-32 md:w-40 flex-shrink-0 card-placeholder">Bystial Dis Pater</div>
                    </div>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><strong class="text-accent font-bold">Targeted Disruption:</strong> Can destroy or negate an opponent's card that is banished.</li>
                        <li><strong class="text-accent font-bold">Recursive Power:</strong> Revives a banished LIGHT or DARK monster to your field once per turn, rebuilding your board state.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Competitive Analysis Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">Competitive Analysis</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Strengths -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-green-400 mb-4">Strengths</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><span class="pro-icon"><i class="fas fa-check-circle"></i></span> <strong class="text-green-400 font-bold">Potent Disruption:</strong> Functions as a powerful, reusable hand trap against any deck using LIGHT/DARK monsters.</li>
                        <li><span class="pro-icon"><i class="fas fa-sync"></i></span> <strong class="text-green-400 font-bold">Resource Loop:</strong> The synergy with "Branded" support creates a self-sustaining engine of advantage.</li>
                        <li><span class="pro-icon"><i class="fas fa-puzzle-piece"></i></span> <strong class="text-green-400 font-bold">Highly Splashable:</strong> The core engine can be easily integrated into many different strategies that use DARK and LIGHT monsters.</li>
                    </ul>
                </div>
                <!-- Weaknesses -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-red-400 mb-4">Weaknesses</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><span class="con-icon"><i class="fas fa-times-circle"></i></span> <strong class="text-red-400 font-bold">Attribute Dependent:</strong> Completely ineffective against decks that do not use LIGHT or DARK monsters.</li>
                        <li><span class="con-icon"><i class="fas fa-ban"></i></span> <strong class="text-red-400 font-bold">Graveyard Hate:</strong> Floodgates like <strong class="text-accent font-bold">Dimension Shifter</strong> or <strong class="text-accent font-bold">Necrovalley</strong> can shut down the engine.</li>
                         <li><span class="con-icon"><i class="fas fa-hand-paper"></i></span> <strong class="text-red-400 font-bold">Predictable Plays:</strong> Relies heavily on resolving <strong class="text-accent font-bold">The Bystial Lubellion</strong>, making it a key choke point.</li>
                    </ul>
                </div>
                <!-- Tech & Engines -->
                <div class="card p-6 pro-con-card">
                    <h3 class="text-xl font-bold text-white mb-4">Key Tech & Synergies</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-300">
                        <li><span class="neutral-icon"><i class="fas fa-fire"></i></span> <strong class="text-accent font-bold">Branded Engine:</strong> The premier pairing, turning Bystials into a full-fledged strategy with Fusion and recursion plays.</li>
                        <li><span class="neutral-icon"><i class="fas fa-dragon"></i></span> <strong class="text-accent font-bold">Dragon Link:</strong> Bystials serve as excellent extenders, providing free bodies for Link and Synchro summons.</li>
                        <li><span class="neutral-icon"><i class="fas fa-skull"></i></span> <strong class="text-accent font-bold">Tearlaments/Chaos:</strong> Perfectly supplements any strategy that actively fills the Graveyard with LIGHT and DARK monsters.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Card Overview Section -->
        <section class="mb-10 md:mb-16">
            <h2 class="text-xl md:text-3xl font-bold text-white mb-6 text-center">The Bystial Cohort</h2>
            <p class="text-gray-300 mb-8 text-center max-w-2xl mx-auto">An overview of the essential cards that define this powerful engine.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">The Bystial Lubellion</h3><p class="text-gray-300 mb-2"><strong>Dragon/Effect</strong></p><p class="text-gray-300">The heart and soul of the engine. It searches any Bystial and sets up the "Branded" continuous Spell/Trap engine.</p></div>
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">Bystial Magnamhut</h3><p class="text-gray-300 mb-2"><strong>Dragon/Effect</strong></p><p class="text-gray-300">The primary searcher. On summon, it sets up an End Phase search for any Dragon monster, ensuring follow-up plays.</p></div>
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">Bystial Saronir</h3><p class="text-gray-300 mb-2"><strong>Dragon/Effect</strong></p><p class="text-gray-300">The key setup tool. When sent to the GY, it dumps a Bystial monster or a "Branded" Spell/Trap to the GY.</p></div>
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">Bystial Druiswurm</h3><p class="text-gray-300 mb-2"><strong>Dragon/Effect</strong></p><p class="text-gray-300">Provides powerful, non-targeting removal by sending an opponent's Special Summoned monster to the GY when it leaves the field.</p></div>
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">Branded Regained</h3><p class="text-gray-300 mb-2"><strong>Continuous Spell</strong></p><p class="text-gray-300">The main advantage engine. It provides a draw whenever a monster is banished and revives a Bystial from the GY.</p></div>
                <div class="card p-6"><h3 class="text-xl font-bold text-accent mb-2">Branded Beast</h3><p class="text-gray-300 mb-2"><strong>Continuous Trap</strong></p><p class="text-gray-300">Offers repeatable, non-targeting destruction by tributing a Dragon monster you control.</p></div>
            </div>
        </section>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- BYSTIAL CHAOS BANNER ANIMATION ---
            const canvas = document.getElementById('chaos-banner');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let particlesArray;
                let chainsArray;

                const setCanvasSize = () => {
                    canvas.width = canvas.offsetWidth;
                    canvas.height = canvas.offsetHeight;
                };
                
                // Particle class for background chaos
                class Particle {
                    constructor(x, y, directionX, directionY, size, color) {
                        this.x = x; this.y = y; this.directionX = directionX;
                        this.directionY = directionY; this.size = size; this.color = color;
                    }
                    draw() {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                        ctx.fillStyle = this.color;
                        ctx.fill();
                    }
                    update() {
                        if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
                        if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
                        this.x += this.directionX;
                        this.y += this.directionY;
                        this.draw();
                    }
                }

                // Chain class for the foreground thematic element
                class Chain {
                    constructor() {
                        this.x = Math.random() * canvas.width;
                        this.y = -50;
                        this.speed = Math.random() * 0.5 + 0.2; // Slower falling speed
                        this.angle = Math.random() * 0.1 - 0.05; // Reduced sideways drift
                        this.links = Math.floor(Math.random() * 12 + 18);
                        this.linkSize = Math.random() * 4 + 3;
                    }

                    draw() {
                        for (let i = 0; i < this.links; i++) {
                            const currentY = this.y - (i * this.linkSize * 1.5);
                            if (currentY < -this.linkSize) continue;
                            
                            const opacity = 0.5 - (i / this.links) * 0.4;
                            ctx.beginPath();
                            
                            // Create a metallic gradient for the chain links
                            const gradient = ctx.createLinearGradient(this.x - this.linkSize, currentY, this.x + this.linkSize, currentY);
                            gradient.addColorStop(0, `rgba(150, 150, 150, ${opacity})`); // Dark grey side
                            gradient.addColorStop(0.5, `rgba(245, 245, 245, ${opacity})`); // Silver highlight
                            gradient.addColorStop(1, `rgba(150, 150, 150, ${opacity})`); // Dark grey side

                            ctx.strokeStyle = gradient;
                            ctx.lineWidth = 2; // Thicker lines for more presence
                            ctx.ellipse(this.x + Math.sin(i * 0.4) * 3, currentY, this.linkSize, this.linkSize * 1.5, 0, 0, Math.PI * 2); // Reduced sway
                            ctx.stroke();
                        }
                    }

                    update() {
                        this.y += this.speed;
                        this.x += this.angle;
                        if (this.y - (this.links * this.linkSize * 1.5) > canvas.height) {
                            this.y = -50;
                            this.x = Math.random() * canvas.width;
                            this.speed = Math.random() * 0.5 + 0.2; // Slower falling speed
                        }
                    }
                }

                function init() {
                    particlesArray = [];
                    chainsArray = [];
                    const colors = ['#a855f7', '#d1d5db', '#7e22ce'];
                    let numberOfParticles = (canvas.height * canvas.width) / 9000;
                    for (let i = 0; i < numberOfParticles; i++) {
                        let size = (Math.random() * 2) + 1;
                        let x = (Math.random() * ((canvas.width - size * 2) - (size * 2)) + size * 2);
                        let y = (Math.random() * ((canvas.height - size * 2) - (size * 2)) + size * 2);
                        let directionX = (Math.random() * 0.4) - 0.2;
                        let directionY = (Math.random() * 0.4) - 0.2;
                        let color = colors[Math.floor(Math.random() * colors.length)];
                        particlesArray.push(new Particle(x, y, directionX, directionY, size, color));
                    }
                    const numberOfChains = Math.floor(canvas.width / 100);
                    for (let i = 0; i < numberOfChains; i++) {
                        chainsArray.push(new Chain());
                    }
                }

                function animate() {
                    requestAnimationFrame(animate);
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    particlesArray.forEach(p => p.update());
                    chainsArray.forEach(c => { c.update(); c.draw(); });
                    connect();
                }

                function connect() {
                    let opacityValue = 1;
                    for (let a = 0; a < particlesArray.length; a++) {
                        for (let b = a + 1; b < particlesArray.length; b++) {
                            let distance = Math.sqrt(Math.pow(particlesArray[a].x - particlesArray[b].x, 2) + Math.pow(particlesArray[a].y - particlesArray[b].y, 2));
                            if (distance < (canvas.width / 7)) {
                                opacityValue = 1 - (distance / 120);
                                ctx.strokeStyle = `rgba(168, 85, 247, ${opacityValue * 0.5})`;
                                ctx.lineWidth = 1;
                                ctx.beginPath();
                                ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                                ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                                ctx.stroke();
                            }
                        }
                    }
                }

                setCanvasSize();
                init();
                animate();

                window.addEventListener('resize', () => {
                    setCanvasSize();
                    init();
                });
            }

            // --- SCRIPT FOR CARD IMAGES ---
            const cardDataCache = {};
            const popup = document.getElementById('card-popup');
            let activePopup = null;
            let lastShown = 0;
            let currentCard = null;

            async function fetchAndProcessCardData(cardName, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                
                container.addEventListener('click', (event) => {
                    event.stopPropagation();
                    showPopup(event, cardName);
                });

                const apiUrl = `https://db.ygoprodeck.com/api/v7/cardinfo.php?name=${encodeURIComponent(cardName)}`;

                try {
                    if (cardDataCache[cardName]) {
                        displayCardImage(cardDataCache[cardName], container);
                        return;
                    }
                    
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error(`API error: ${response.status}`);
                    const data = await response.json();
                    const cardInfo = data?.data?.[0];
                    
                    if (cardInfo) {
                        cardDataCache[cardName] = cardInfo;
                        displayCardImage(cardInfo, container);
                    } else {
                        throw new Error("Card data not found in API response.");
                    }
                } catch (error) {
                    console.error(`Failed to fetch data for "${cardName}":`, error);
                    container.innerHTML = `<div class="card-placeholder">${cardName}</div>`;
                }
            }

            function displayCardImage(cardInfo, container) {
                 const imageUrl = cardInfo.card_images?.[0]?.image_url;
                 if (imageUrl) {
                    const img = document.createElement('img');
                    img.src = imageUrl;
                    img.alt = cardInfo.name;
                    img.className = 'w-full h-auto rounded-lg shadow-md';
                    container.innerHTML = '';
                    container.appendChild(img);
                } else {
                     container.innerHTML = `<div class="card-placeholder">${cardInfo.name}</div>`;
                }
            }
            
            function showPopup(event, cardName) {
                if (currentCard === cardName) {
                    hidePopup();
                    return;
                }
                hidePopup(); // Ensure any existing popup is hidden first
                if (!popup) return;
                const cardInfo = cardDataCache[cardName];
                if (!cardInfo) return;

                let stats = '';
                let atkDef = [];
                if (cardInfo.atk !== undefined) atkDef.push(`ATK/${cardInfo.atk}`);
                if (cardInfo.def !== undefined) atkDef.push(`DEF/${cardInfo.def}`);
                if (cardInfo.linkval) atkDef.push(`LINK-${cardInfo.linkval}`);
                if(atkDef.length > 0) {
                    stats = `<p id="card-popup-stats" class="mt-2">${atkDef.join(' ')}</p>`;
                }
                
                const cardType = cardInfo.type.includes('Monster') ? `[${cardInfo.race} / ${cardInfo.type.replace(' Monster', '')}]` : `[${cardInfo.race} Card]`;

                popup.innerHTML = `
                    <div>
                        <h3>${cardInfo.name}</h3>
                        <p class="text-xs text-purple-300">${cardType}</p>
                        <div class="w-full h-px bg-purple-700 my-2"></div>
                        <p class="text-xs">${cardInfo.desc.replace(/\r\n/g, '<br>')}</p>
                        ${stats}
                    </div>
                `;
                
                movePopup(event);
                popup.style.display = 'block';
                setTimeout(() => { popup.style.opacity = 1; }, 10);
                activePopup = popup;
                lastShown = Date.now();
                currentCard = cardName;
            }

            function hidePopup() {
                if (Date.now() - lastShown < 100) return; // Ignore hide calls immediately after showing
                if (activePopup) {
                    activePopup.style.opacity = 0;
                    setTimeout(() => { 
                        if (activePopup) activePopup.style.display = 'none'; 
                    }, 200);
                    activePopup = null;
                    currentCard = null;
                }
            }

            function movePopup(event) {
                if (!popup) return;
                const popupWidth = popup.offsetWidth;
                const popupHeight = popup.offsetHeight;
                const cushion = 20;

                let x = event.clientX + cushion;
                let y = event.clientY + cushion;

                if (x + popupWidth > window.innerWidth) {
                    x = event.clientX - popupWidth - cushion;
                }
                if (y + popupHeight > window.innerHeight) {
                    y = event.clientY - popupHeight - cushion;
                }

                popup.style.left = `${x}px`;
                popup.style.top = `${y}px`;
            }

            // Global click listener to close the popup
            document.addEventListener('click', hidePopup);

            const imageContainers = {
                'aluber-img-container': 'Aluber the Jester of Despia',
                'magnamhut-img-container': 'Bystial Magnamhut',
                'lubellion-img-container': 'The Bystial Lubellion',
                'mirrorjade-img-container': 'Mirrorjade the Iceblade Dragon',
                'rindbrumm-img-container': 'Rindbrumm the Striking Dragon',
                'dispater-img-container': 'Bystial Dis Pater'
            };

            for (const [containerId, cardName] of Object.entries(imageContainers)) {
                fetchAndProcessCardData(cardName, containerId);
            }
        });
    </script>
</body>
</html>



